{"version":3,"file":"aves.js","mappings":"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","sources":["webpack://variousjs/./src/components/aves/middleware.ts","webpack://variousjs/external amd \"@floating-ui/react-dom\"","webpack://variousjs/external amd \"react\"","webpack://variousjs/webpack/bootstrap","webpack://variousjs/webpack/runtime/compat get default export","webpack://variousjs/webpack/runtime/define property getters","webpack://variousjs/webpack/runtime/hasOwnProperty shorthand","webpack://variousjs/webpack/runtime/make namespace object","webpack://variousjs/./src/components/aves/index.tsx"],"sourcesContent":["import { Middleware } from '@floating-ui/react-dom'\n\nexport const anchorCssProperties = (): Middleware => ({\n  name: 'anchorCssProperties',\n  async fn(data) {\n    const { rects, elements, platform } = data\n    const { width, height } = rects.reference\n    const { width: popoverWidth, height: popoverHeight } = rects.floating\n    elements.floating.style.setProperty('--selection-popover-select-width', `${width}px`)\n    elements.floating.style.setProperty('--selection-popover-select-height', `${height}px`)\n    const newDimensions = await platform.getDimensions(elements.floating)\n    if (popoverWidth !== newDimensions.width || popoverHeight !== newDimensions.height) {\n      return { reset: { rects: true } }\n    }\n    return {}\n  },\n})\n\nexport const transformOrigin = (options: { arrowWidth: number; arrowHeight: number }): Middleware => ({\n  name: 'transformOrigin',\n  fn(data) {\n    const { rects, middlewareData } = data\n\n    const isArrowHidden = middlewareData.arrow?.centerOffset !== 0\n    const arrowWidth = isArrowHidden ? 0 : options.arrowWidth\n    const arrowHeight = isArrowHidden ? 0 : options.arrowHeight\n    const noArrowAlign = '50%'\n    const arrowXCenter = (middlewareData.arrow?.x ?? 0) + arrowWidth / 2\n    const x = isArrowHidden ? noArrowAlign : `${arrowXCenter}px`\n    const y = `${rects.floating.height + arrowHeight}px`\n\n    return { data: { x, y } }\n  },\n})\n","module.exports = __WEBPACK_EXTERNAL_MODULE__floating_ui_react_dom__;","module.exports = __WEBPACK_EXTERNAL_MODULE_react__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import React, {\n  CSSProperties,\n  ReactNode,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react'\nimport {\n  useFloating,\n  autoUpdate,\n  offset,\n  shift,\n  limitShift,\n  flip,\n  hide,\n  inline,\n} from '@floating-ui/react-dom'\nimport { anchorCssProperties, transformOrigin } from './middleware'\n\nexport interface Props {\n  children: ReactNode\n  className?: string\n  style?: CSSProperties\n}\n\nconst Aves = (props: Props) => {\n  const [selectionText, setSelectionText] = useState<string>()\n  const textWrapperRef = useRef<HTMLDivElement>(null)\n  const bodyUserSelect = useRef(document.body.style.userSelect)\n\n  const detectOverflowOptions = {\n    padding: 10,\n  }\n\n  const { x, y, strategy, refs, isPositioned } = useFloating({\n    strategy: 'fixed',\n    placement: 'top',\n    whileElementsMounted: autoUpdate,\n    middleware: [\n      inline(),\n      anchorCssProperties(),\n      offset({ mainAxis: 10, alignmentAxis: 0 }),\n      flip(detectOverflowOptions),\n      shift({\n        mainAxis: true,\n        crossAxis: false,\n        limiter: limitShift(),\n        ...detectOverflowOptions,\n      }),\n      transformOrigin({ arrowWidth: 10, arrowHeight: 5 }),\n      hide({ strategy: 'referenceHidden' }),\n    ],\n  })\n\n  const onCheckSelection = useCallback(async () => {\n    setSelectionText(undefined)\n    await new Promise((r) => setTimeout(r))\n\n    const selection = document.getSelection()\n\n    if (!selection || selection.isCollapsed || !selection.toString().length) {\n      return\n    }\n    if (!textWrapperRef.current?.contains(selection.anchorNode)) {\n      return\n    }\n\n    const range = selection.getRangeAt(0)\n    setSelectionText(range.toString())\n    refs.setReference(range)\n  }, [refs])\n\n  useEffect(() => {\n    document.addEventListener('pointerup', onCheckSelection)\n    return () => {\n      document.removeEventListener('pointerup', onCheckSelection)\n    }\n  }, [onCheckSelection])\n\n  return (\n    <>\n      <div\n        style={{ userSelect: 'text', ...props.style }}\n        ref={textWrapperRef}\n        className={props.className}\n        onPointerDown={() => {\n          document.body.style.userSelect = 'none'\n        }}\n        onPointerUp={() => {\n          document.body.style.userSelect = bodyUserSelect.current\n        }}\n      >\n        {props.children}\n      </div>\n      <div\n        ref={refs.setFloating}\n        style={{\n          position: strategy,\n          top: 0,\n          left: 0,\n          transform: isPositioned\n            ? `translate3d(${Math.round(x ?? 0)}px, ${Math.round(y ?? 0)}px, 0)`\n            : 'translate3d(0, -200%, 0)',\n          minWidth: 'max-content',\n          zIndex: 999,\n          transition: 'opacity 0.3s ease-in-out',\n          opacity: selectionText === undefined ? 0 : 1,\n          visibility: selectionText === undefined ? 'hidden' : 'visible',\n        }}\n      >\n        <div style={{ userSelect: 'none' }}>\n          <div style={{ background: 'gray' }}>\n            {selectionText}\n          </div>\n        </div>\n      </div>\n    </>\n  )\n}\n\nexport default Aves\n"],"names":["anchorCssProperties","name","fn","data","rects","elements","platform","width","height","reference","popoverWidth","popoverHeight","floating","style","setProperty","newDimensions","getDimensions","reset","transformOrigin","options","middlewareData","isArrowHidden","arrow","centerOffset","arrowWidth","arrowHeight","noArrowAlign","arrowXCenter","x","y","React","useCallback","useEffect","useRef","useState","useFloating","autoUpdate","offset","shift","limitShift","flip","hide","inline","Aves","props","selectionText","setSelectionText","textWrapperRef","bodyUserSelect","document","body","userSelect","detectOverflowOptions","padding","strategy","refs","isPositioned","placement","whileElementsMounted","middleware","mainAxis","alignmentAxis","crossAxis","limiter","onCheckSelection","undefined","Promise","r","setTimeout","selection","getSelection","isCollapsed","toString","length","current","contains","anchorNode","range","getRangeAt","setReference","addEventListener","removeEventListener","className","children","setFloating","position","top","left","transform","Math","round","minWidth","zIndex","transition","opacity","visibility","background"],"sourceRoot":""}