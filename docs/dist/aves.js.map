{"version":3,"file":"aves.js","mappings":"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","sources":["webpack://variousjs/external amd \"@floating-ui/react-dom\"","webpack://variousjs/external amd \"react\"","webpack://variousjs/webpack/bootstrap","webpack://variousjs/webpack/runtime/compat get default export","webpack://variousjs/webpack/runtime/define property getters","webpack://variousjs/webpack/runtime/hasOwnProperty shorthand","webpack://variousjs/webpack/runtime/make namespace object","webpack://variousjs/./src/components/aves/index.tsx"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__floating_ui_react_dom__;","module.exports = __WEBPACK_EXTERNAL_MODULE_react__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import React, {\n  ComponentType,\n  CSSProperties,\n  ReactNode,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react'\nimport {\n  useFloating,\n  autoUpdate,\n  offset,\n  shift,\n  limitShift,\n  flip,\n  hide,\n  inline,\n} from '@floating-ui/react-dom'\n\nexport interface Props {\n  children: ReactNode,\n  className?: string,\n  style?: CSSProperties,\n  popup: ComponentType<{ text?: string }>,\n}\n\nconst Aves = (props: Props) => {\n  const Popup = props.popup\n  const [selectionText, setSelectionText] = useState<string>()\n  const textWrapperRef = useRef<HTMLDivElement>(null)\n  const bodyUserSelect = useRef(document.body.style.userSelect)\n  const textRef = useRef<string>(undefined)\n\n  const { x, y, strategy, refs, isPositioned } = useFloating({\n    strategy: 'fixed',\n    placement: 'top',\n    whileElementsMounted: autoUpdate,\n    middleware: [\n      inline(),\n      offset({ mainAxis: 10, alignmentAxis: 0 }),\n      flip(),\n      shift({\n        mainAxis: true,\n        crossAxis: false,\n        limiter: limitShift(),\n      }),\n      hide({ strategy: 'referenceHidden' }),\n    ],\n  })\n\n  const onSelection = useCallback(async () => {\n    setSelectionText(undefined)\n    await new Promise((r) => setTimeout(r))\n\n    const selection = document.getSelection()\n\n    if (!selection || selection.isCollapsed || !selection.toString().length) {\n      return\n    }\n    if (!textWrapperRef.current?.contains(selection.anchorNode)) {\n      return\n    }\n\n    const range = selection.getRangeAt(0)\n    textRef.current = range.toString()\n    setSelectionText(range.toString())\n    refs.setReference(range)\n  }, [refs])\n\n  useEffect(() => {\n    document.addEventListener('pointerup', onSelection)\n    return () => {\n      document.removeEventListener('pointerup', onSelection)\n    }\n  }, [onSelection])\n\n  return (\n    <>\n      <div\n        style={{ userSelect: 'text', ...props.style }}\n        ref={textWrapperRef}\n        className={props.className}\n        onPointerDown={() => {\n          document.body.style.userSelect = 'none'\n        }}\n        onPointerUp={() => {\n          document.body.style.userSelect = bodyUserSelect.current\n        }}\n      >\n        {props.children}\n      </div>\n      <div\n        ref={refs.setFloating}\n        style={{\n          position: strategy,\n          top: 0,\n          left: 0,\n          transform: isPositioned\n            ? `translate3d(${Math.round(x ?? 0)}px, ${Math.round(y ?? 0)}px, 0)`\n            : 'translate3d(0, -200%, 0)',\n          userSelect: 'none',\n          minWidth: 'max-content',\n          zIndex: 9999,\n          transition: 'opacity 0.3s ease-in-out',\n          opacity: selectionText === undefined ? 0 : 1,\n          visibility: selectionText === undefined ? 'hidden' : 'visible',\n        }}\n      >\n        <Popup text={textRef.current} />\n      </div>\n    </>\n  )\n}\n\nexport default Aves\n"],"names":["React","useCallback","useEffect","useRef","useState","useFloating","autoUpdate","offset","shift","limitShift","flip","hide","inline","Aves","props","Popup","popup","selectionText","setSelectionText","textWrapperRef","bodyUserSelect","document","body","style","userSelect","textRef","undefined","x","y","strategy","refs","isPositioned","placement","whileElementsMounted","middleware","mainAxis","alignmentAxis","crossAxis","limiter","onSelection","Promise","r","setTimeout","selection","getSelection","isCollapsed","toString","length","current","contains","anchorNode","range","getRangeAt","setReference","addEventListener","removeEventListener","className","children","setFloating","position","top","left","transform","Math","round","minWidth","zIndex","transition","opacity","visibility"],"sourceRoot":""}